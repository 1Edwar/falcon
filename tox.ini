[tox]
envlist = py26,
          py27,
          py27_cython,
          py33,
          py33_cython,
          pypy,
          pep8,
          pylint,
          py26_bench,
          py27_bench,
          py33_bench,
          pypy_bench

[testenv]
deps = -r{toxinidir}/tools/test-requires
commands = {toxinidir}/tools/clean_cythoned.sh {toxinidir}/falcon
           nosetests {posargs}

[testenv:py27]
deps = -r{toxinidir}/tools/test-requires
       nose-cprof
commands = {toxinidir}/tools/clean_cythoned.sh {toxinidir}/falcon
           nosetests \
               --with-cprofile \
               --cprofile-stats-erase \
               --cprofile-stats-file=cprofile.dat \
               {posargs}

[testenv:py27_cython]
deps = -r{toxinidir}/tools/test-requires
       cython
basepython = python2.7
commands = {toxinidir}/tools/clean_cythoned.sh {toxinidir}/falcon
           nosetests \
               {posargs}

[testenv:py33_cython]
deps = -r{toxinidir}/tools/test-requires
       cython
basepython = python3.3
commands = {toxinidir}/tools/clean_cythoned.sh {toxinidir}/falcon
           nosetests \
               {posargs}

[testenv:py3kwarn]
deps = py3kwarn
commands = py3kwarn falcon

[testenv:pep8]
deps = flake8
commands = flake8 \
           --max-complexity=12 \
           --exclude=./build,.venv,.tox,dist,doc,./falcon/bench/nuts \
           --ignore=F403

[testenv:pylint]
deps = pylint
commands = pylint falcon \
           --ignore=bench,tests \
           -E

[testenv:py26_bench]
deps = -r{toxinidir}/tools/bench-requires
basepython = python2.6
commands = falcon-bench

[testenv:py27_bench]
deps = -r{toxinidir}/tools/bench-requires
basepython = python2.7
commands = falcon-bench

[testenv:py33_bench]
deps = -r{toxinidir}/tools/bench-requires
basepython = python3.3
commands = falcon-bench

[testenv:pypy_bench]
deps = -r{toxinidir}/tools/bench-requires
basepython = pypy
commands = falcon-bench
